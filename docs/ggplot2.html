<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>ggplot2 versions of simple plots</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="SI-md-08.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Geographic Data Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="overview.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lecture topics</li>
    <li>
      <a href="lec01.html">Introduction to the course</a>
    </li>
    <li>
      <a href="lec02.html">Univariate plots</a>
    </li>
    <li>
      <a href="lec03.html">Bivariate plots</a>
    </li>
    <li>
      <a href="lec04.html">Descriptive statistics</a>
    </li>
    <li>
      <a href="lec05.html">Multivariate plots</a>
    </li>
    <li>
      <a href="ggplot2.html">ggplot2 versions of basic plots</a>
    </li>
    <li>
      <a href="lec06.html">Maps in R</a>
    </li>
    <li>
      <a href="lec07.html">Geospatial analysis in R</a>
    </li>
    <li>
      <a href="lec08.html">Data wrangling and matrix algebra</a>
    </li>
    <li>
      <a href="lec09.html">Reference distributions</a>
    </li>
    <li>
      <a href="lec10.html">Statistical inference</a>
    </li>
    <li>
      <a href="lec11.html">Analysis of variance</a>
    </li>
    <li>
      <a href="lec12.html">Regression analysis</a>
    </li>
    <li>
      <a href="lec13.html">More regression analysis</a>
    </li>
    <li>
      <a href="lec14.html">Nonparametric regression</a>
    </li>
    <li>
      <a href="lec15.html">GLMs, GAMs, and CARTs</a>
    </li>
    <li>
      <a href="lec16.html">Principal components and factor analyses</a>
    </li>
    <li>
      <a href="lec17.html">MANOVA and discriminant analysis</a>
    </li>
    <li>
      <a href="lec18.html">Multivariate distances and cluster analysis</a>
    </li>
    <li>
      <a href="lec19.html">High-resolution and high-dimension data</a>
    </li>
    <li>
      <a href="lec20.html">Analysis and visualization of large raster data sets</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Exercises</li>
    <li>
      <a href="ex01.html">Exercise 01 -- Getting R and RStudio</a>
    </li>
    <li>
      <a href="ex02.html">Exercise 02 -- Univariate plots</a>
    </li>
    <li>
      <a href="ex03.html">Exercise 03 -- Bivariate plots and descriptive statistics</a>
    </li>
    <li>
      <a href="ex04.html">Exercise 04 -- Multivariate plots</a>
    </li>
    <li>
      <a href="ex05.html">Exercise 05 -- Data wrangling and matrix algebra</a>
    </li>
    <li>
      <a href="ex06.html">Exercise 06 -- CI's, t-tests, ANOVA</a>
    </li>
    <li>
      <a href="ex07.html">Exercise 07 -- Regression analysis</a>
    </li>
    <li>
      <a href="ex08.html">Exercise 08 -- Multivariate analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="packages-and-data.html">Packages and data</a>
    </li>
    <li>
      <a href="vm_inst.html">Virtual machine instructions</a>
    </li>
    <li>
      <a href="readings.html">Readings</a>
    </li>
    <li>
      <a href="datasets.html">Datasets</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">ggplot2 versions of simple plots</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#univariate-and-bivariate-plots"><span class="toc-section-number">2</span> Univariate and bivariate plots</a>
<ul>
<li><a href="#simple-plots"><span class="toc-section-number">2.1</span> Simple plots</a></li>
<li><a href="#dotchartsdotplots"><span class="toc-section-number">2.2</span> Dotcharts/Dotplots</a></li>
<li><a href="#boxplots"><span class="toc-section-number">2.3</span> Boxplots</a></li>
<li><a href="#histograms-and-density-plots"><span class="toc-section-number">2.4</span> Histograms and density plots</a></li>
</ul></li>
<li><a href="#bivariate-plots"><span class="toc-section-number">3</span> Bivariate plots</a>
<ul>
<li><a href="#scatter-diagrams"><span class="toc-section-number">3.1</span> Scatter diagrams</a></li>
</ul></li>
<li><a href="#multivariate-plots"><span class="toc-section-number">4</span> Multivariate plots</a>
<ul>
<li><a href="#labelled-scatter-plots"><span class="toc-section-number">4.1</span> Labelled scatter plots</a></li>
<li><a href="#trellislattice-like-plots"><span class="toc-section-number">4.2</span> Trellis/Lattice-like plots</a></li>
</ul></li>
<li><a href="#readings"><span class="toc-section-number">5</span> Readings</a></li>
</ul>
</div>

<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p>
<span style="color: #00cc00;">NOTE: This page has been revised for Winter 2021, but may undergo further edits.</span>
</p>
<div id="introduction" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The <strong>R</strong> package <code>ggplot2</code> by Hadley Wickham provides an alternative approach to the “base” graphics in <strong>R</strong> for constructing plots and maps, and is inspired by Lee Wilkinson’s <em>The Grammar of Graphics</em> book (Springer, 2nd Ed. 2005). The basic premise of the <em>Grammar of Graphics</em> book, and of the underlying design of the package, is that data graphics, like a language, are built upon some basic components that are assembled or layered on top of one another. In the case of English (e.g Garner, B., 2016, <em>The Chicago Guide to Grammar, Usage and Punctuation</em>, Univ. Chicago Press), there are eight “parts of speech” from which sentences are assembled:</p>
<ul>
<li><em>Nouns</em> (e.g. <em>computer</em>, <em>classroom</em>, <em>data</em>, …), including gerunds (e.g. <em>readings</em>)</li>
<li><em>Pronouns</em> (e.g. <em>he</em>, <em>she</em>, <em>they</em>, …)</li>
<li><em>Adjectives</em> (e.g. <em>good</em>, <em>green</em>, <em>my</em>, <em>year-to-year</em>, …, including articles, e.g. <em>a</em>, <em>the</em>)</li>
<li><em>Verbs</em> (e.g. <em>analyze</em>, <em>write</em>, <em>discuss</em>, <em>computing</em>, …)</li>
<li><em>Adverbs</em> (e.g. “-ly” words, <em>very</em>, <em>loudly</em>, <em>bigly</em>, <em>near</em>, <em>far</em>, …)</li>
<li><em>Prepositions</em> (e.g. <em>on</em>, <em>in</em>, <em>to</em>, …)</li>
<li><em>Conjunctives</em> (e.g. <em>and</em>, <em>but</em>, …)</li>
<li><em>Interjections</em> (e.g. <em>damn</em>)</li>
</ul>
<p>(but as Garner notes, those categories “aren’t fully settled…” p. 18).</p>
<p>In the case of graphics (e.g. Wickham, H., 2016, <em>ggplot2 – Elegant Graphics for Data Analysis, 2nd. Ed.</em>, Springer, available online from <a href="http://library.uoregon.edu">[http://library.uoregon.edu]</a>) the components are:</p>
<ul>
<li><em>Data</em> (e.g. in a dataframe)</li>
<li><em>Coordinate Systems</em> (the coordinate system of a plot)</li>
<li><em>Geoms</em> and their “aesthetic mappings” (the geometric objects like points, lines, polygons that represent the data)</li>
</ul>
<p>These functions return <em>Layers</em> (made up of geometric elements) that build up the plot. In addition, plots are composed of</p>
<ul>
<li><em>Stats</em> (or “statistical transformations”, i.e. curves)</li>
<li><em>Scales</em> (that map data into the “aesthetic space”, i.e. axes and legends)</li>
<li><em>Facets</em> (e.g subsets of data in individual plots)</li>
<li><em>Legends</em> and</li>
<li><em>Themes</em> (that control things like background colors, fonts, etc.)</li>
</ul>
</div>
<div id="univariate-and-bivariate-plots" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Univariate and bivariate plots</h1>
<div id="simple-plots" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Simple plots</h2>
<p>Load the <code>ggplot2</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2 versions of plots</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Here is the <strong>R</strong> base graphics simple index plot:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># index plot</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(sumcr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Length)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/index-1.png" width="2100" /></p>
<p>The <code>ggplot2</code> package contains a method, invoked by the <code>qplot()</code> function for creating quick (hence the name) versions of the base-graphics plots. The general recommendation these days is to not rely on <code>qplot()</code> that much, but to learn the full capability of <code>ggplot2</code> at the beginning.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Length)), Length)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/index_gg-1.png" width="2100" /></p>
<p>Here’s the stripchart, plain and stacked:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stripchart</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(Length)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/stripcharts-1.png" width="2100" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(Length, <span class="at">method=</span><span class="st">&quot;stack&quot;</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/stripcharts-2.png" width="2100" /></p>
<p>… and the <code>qplot()</code> versions:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(Length, <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(Length)))</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/stripcharts_gg1-1.png" width="2100" /></p>
<p>The full <code>ggplot2()</code> almost reproduces the base-graphics version. Note the use of the <code>aes()</code> (aesthetic) function for describing the basic plot, which then has the dotplot added using the <code>geom_dotplot()</code> function. The <code>theme_bw()</code> term specifies the simple black-and-white theme. As in the case of a histogram, the <code>binwidth</code> parameter controls the granularity of the plot, and `coord_fixed() changes the aspect ratio of the plot. (The white space can be cropped when saving the image.)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>sumcr, <span class="fu">aes</span>(<span class="at">x =</span> Length)) <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binwidth =</span> <span class="fl">0.25</span>, <span class="at">method =</span> <span class="st">&quot;histodot&quot;</span>) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="fl">4.0</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/stripchargs_gg2-1.png" width="2100" /></p>
</div>
<div id="dotchartsdotplots" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Dotcharts/Dotplots</h2>
<p>Here’s the base-graphics Cleveland-style dotchart.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dot charts</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(WidthWS, <span class="at">labels=</span><span class="fu">as.character</span>(Location), <span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/dotchart-1.png" width="2100" /></p>
<p>… and the <code>ggplot2</code> equivalent:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>WidthWS, <span class="at">y=</span>Location)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) </span></code></pre></div>
<p><img src="ggplot2_files/figure-html/dotchart_gg-1.png" width="2100" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>WidthWS, <span class="at">y=</span>Location)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/dotchart_gg-2.png" width="2100" /></p>
<p>Note the subtle difference produced by the use of the <code>theme_bw()</code> term. The plots are basically x-y plots (specified by the <code>aes(x=WidthWS, y=Location)</code> arguements), with the points themselves added by the <code>geom_point()</code> term.</p>
<p>Here’s the dotchart, with rows ordered by the <code>WidthWS</code> values:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">order</span>(WidthWS)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(WidthWS[index], <span class="at">labels=</span><span class="fu">as.character</span>(Location[index]), <span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/dotchart_ordered-1.png" width="2100" /></p>
<p>… and the <code>ggplot2</code> equivalent–note the use of the <code>theme()</code> term to modify the label size:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>WidthWS, <span class="at">y=</span><span class="fu">reorder</span>(Location, WidthWS))) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">4</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>))</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/dotchart_ordered_gg-1.png" width="2100" /></p>
</div>
<div id="boxplots" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> Boxplots</h2>
<p>Here is the standard boxplot:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(WidthWS <span class="sc">~</span> HU, <span class="at">range=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/boxplot-1.png" width="2100" /></p>
<p>… and the <code>qplot()</code> version:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(HU, WidthWS, <span class="at">data=</span>sumcr, <span class="at">geom=</span><span class="st">&quot;boxplot&quot;</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/boxplot_q-1.png" width="2100" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sumcr, <span class="fu">aes</span>(<span class="at">x=</span>HU, <span class="at">y=</span>WidthWS)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/boxplot_gg-1.png" width="2100" /></p>
<p>The actual data points can be added to the boxplot, by specifying an additional graphical element using the <code>geom_point()</code> term.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>HU, <span class="at">y=</span>WidthWS)) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="ggplot2_files/figure-html/boxplot_gg2-1.png" width="2100" /> Detach the <code>sumcr</code> dataframe.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(sumcr)</span></code></pre></div>
</div>
<div id="histograms-and-density-plots" class="section level2" number="2.4">
<h2 number="2.4"><span class="header-section-number">2.4</span> Histograms and density plots</h2>
<p>The base-graphics histogram, with <code>breaks = 20</code> looks like this:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histograms</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(scanvote)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Yes, <span class="at">breaks=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/histogram-1.png" width="2100" /></p>
<p>Here’s the <code>ggplot2</code> version, with the biwidth specified explicitly (e.g., 1.0)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span>Yes)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/hist_gg1-1.png" width="2100" /></p>
<p>Here’s another <code>ggplot</code> version, with more control over appearance, and with the edge of the first bin explicitly specified.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span>Yes)) <span class="sc">+</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">boundary=</span><span class="fl">25.5</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/histogram_gg2-1.png" width="2100" /></p>
<p>Here’s a version with the individual data points added–note how it is built up from a basic plot by progressively adding graphical elements:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span>Yes)) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">boundary=</span><span class="fl">25.5</span>) <span class="sc">+</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">y=</span><span class="dv">0</span>) </span></code></pre></div>
<p><img src="ggplot2_files/figure-html/histogram_gg4-1.png" width="2100" /></p>
<p>Here’s a base-graphics density plot:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># density plots</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>Yes.density <span class="ot">&lt;-</span> <span class="fu">density</span>(Yes)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Yes.density)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/density-1.png" width="2100" /> … and a version the <code>ggplot2</code> density plot:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span>Yes)) <span class="sc">+</span> <span class="fu">geom_density</span>() <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fl">0.0</span>, <span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/density_gg-1.png" width="2100" /></p>
<p>The combined histogram, density and rug plot via the base graphics:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Yes.density <span class="ot">&lt;-</span> <span class="fu">density</span>(Yes)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Yes, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Yes.density)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rug</span>(Yes)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/histdensrug-1.png" width="2100" /></p>
<p>And here’s a <code>ggplot</code> version, with three distinct layers:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span>Yes)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">data=</span>scanvote, <span class="fu">aes</span>(<span class="at">x=</span>Yes, <span class="at">y=</span>..density..), <span class="at">binwidth=</span><span class="dv">1</span>, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">boundary=</span><span class="fl">25.5</span>) <span class="sc">+</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">data=</span>scanvote, <span class="fu">aes</span>(<span class="at">x=</span>Yes)) </span></code></pre></div>
<p><img src="ggplot2_files/figure-html/histdenrug_gg-1.png" width="2100" /> geom_density(data=scanvote, aes(x=Yes, y=..density..)) +</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(scanvote)</span></code></pre></div>
<p><a href="ggplot2.html">[Back to top]</a></p>
</div>
</div>
<div id="bivariate-plots" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Bivariate plots</h1>
<div id="scatter-diagrams" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Scatter diagrams</h2>
<p>There are <code>ggplot2</code> equivalents of the common “base-package” bivariate plots, that offer finer control of the appearance of the plots than can usually be acheived with the base plots.</p>
<p>Here’s the base plot version of a scatter diagram:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plots</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use Oregon climate-station data </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(orstationc)</span></code></pre></div>
<pre><code>## The following objects are masked _by_ .GlobalEnv:
## 
##     lat, lon</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(elev,tann)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat1-1.png" width="2100" /></p>
<p>… and the `<code>qplot</code> version:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(elev, tann, <span class="at">data=</span>orstationc) <span class="sc">+</span> <span class="fu">theme_gray</span>()</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat2-1.png" width="2100" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(orstationc)</span></code></pre></div>
<p>Here are the two scatter plots of yes votes vs population in the Scandinavian data set, using base graphic:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use Scandinavian EU vote data [scanvote.csv]</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(scanvote)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pop, Yes)         <span class="co"># arithmetic axis</span></span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat4-1.png" width="2100" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log10</span>(Pop), Yes)  <span class="co"># logrithmic axis</span></span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat4-2.png" width="2100" /></p>
<p>The <code>ggplot2</code> versions of those plots can be compares side-by-side by generating the plots and saving them as objects (<code>plot</code> and <code>plot2</code>), and then using a function <code>grid.arrange()</code> from the <code>gridExtra</code> package to plot the two objects:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span>Pop, <span class="at">y=</span>Yes)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log10</span>(Pop), <span class="at">y=</span>Yes)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat5-1.png" width="2100" /></p>
<p>Note that <code>ggplot2</code> allows one to transform the coordinate system as well as the values of the individual variables. Here a log10 scaling of the x-axis is done. Note that the overall appearance of the plots is identical–it’s the x-axes that differ.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log10</span>(Pop), <span class="at">y=</span>Yes)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span>Pop, <span class="at">y=</span>Yes)) <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">x=</span><span class="st">&quot;log10&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat6-1.png" width="2100" /></p>
<p>The same kind of “point decoration” offered by the base package can be done using <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log10</span>(Pop), <span class="at">y=</span>Yes, <span class="at">color=</span>Country)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log10</span>(Pop), <span class="at">y=</span>Yes, <span class="at">shape=</span>Country)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat7-1.png" width="2100" /></p>
<p>Labeling of points using <code>ggplot</code> is possible, and again offers more fine control, such as some ability to deal with text overlap.</p>
<p>Here is the base plotting version of a text-labelled scatter plot:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log10</span>(Pop),Yes, <span class="at">type=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">log10</span>(Pop),Yes, <span class="at">labels=</span><span class="fu">as.character</span>(Country)) <span class="co"># text</span></span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat8-1.png" width="2100" /></p>
<p>A <code>ggplot</code> version of the same ia shown below. The <code>check_overlap()</code> function attempts to move the labels to avoid overplotting. To see where the datapoints actualy lie, they are added as dots.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log10</span>(Pop), <span class="at">y=</span>Yes, <span class="at">label=</span><span class="fu">as.character</span>(Country))) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_gray</span>()</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat9-1.png" width="2100" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scanvote, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log10</span>(Pop), <span class="at">y=</span>Yes, <span class="at">label=</span><span class="fu">as.character</span>(Country))) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_gray</span>()</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat10-1.png" width="2100" /></p>
<p>Note the difference between the plots–the first plots a simple text string using <code>geom_text()</code> while the second plots a more formal label using <code>geom_label()</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(scanvote)</span></code></pre></div>
<p>The grid extra package obviously makes it efficient to plot different variables side by side, which is often a better approach than plotting them on the same plot:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use Oregon climate-station data [orstationc.csv]</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(orstationc)</span></code></pre></div>
<pre><code>## The following objects are masked _by_ .GlobalEnv:
## 
##     lat, lon</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x=</span>elev, <span class="at">y=</span>tann)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_gray</span>()</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>right <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x=</span>elev, <span class="at">y=</span>pann)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_gray</span>()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(left, right, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat11-1.png" width="2100" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(orstationc)</span></code></pre></div>
<p>Lastly, here’s a scatter plot smoothing example, beginning with the base-package version:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use Oregon climate station annual temperature data </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ortann)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(elevation, tann)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(elevation,tann))</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/scat12-1.png" width="2100" /></p>
<p>The <code>ggplot2</code> version uses <code>stat_smooth()</code> to get the lowess curve (and confidence band):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ortann, <span class="fu">aes</span>(<span class="at">x =</span> elevation, <span class="at">y =</span> tann)) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">span =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="ggplot2_files/figure-html/scat13-1.png" width="2100" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ortann)</span></code></pre></div>
<p><a href="ggplot2.html">[Back to top]</a></p>
</div>
</div>
<div id="multivariate-plots" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Multivariate plots</h1>
<div id="labelled-scatter-plots" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Labelled scatter plots</h2>
<p>In addition to the simple catagorial (or factor) labelling of plots, the <code>ggplot2</code> package supports more elaborate, or computed, decoration or coloring of plots to examine the role of additional variables on bivariate relationships.</p>
<p>Here’s the <code>ggplot2</code> version of the specmap data. Recall that the relationship between ice volume and insolation anomalies (or differences from the present day, which are considered to be the pacemake of the ice ages) is weak when examined superficially.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(specmap)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(O18 <span class="sc">~</span> Insol, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv1-1.png" width="2100" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(O18, Insol)</span></code></pre></div>
<pre><code>## [1] -0.2415094</code></pre>
<p>As we saw earlier, on approach is to look at the time series plot of O18 values, and use insolation to colorize the individual points.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(classInt) <span class="co"># class-interval recoding library</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># first block -- setup</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>plotvals <span class="ot">&lt;-</span> Insol</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>nclr <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>plotclr <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(nclr,<span class="st">&quot;PuOr&quot;</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>plotclr <span class="ot">&lt;-</span> plotclr[nclr<span class="sc">:</span><span class="dv">1</span>] <span class="co"># reorder colors</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">classIntervals</span>(plotvals, nclr, <span class="at">style=</span><span class="st">&quot;quantile&quot;</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>colcode <span class="ot">&lt;-</span> <span class="fu">findColours</span>(class, plotclr)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># second block -- plot</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(O18 <span class="sc">~</span> Age, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">2.5</span>,<span class="sc">-</span><span class="fl">2.5</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(O18 <span class="sc">~</span> Age, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>colcode, <span class="at">cex=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv2-1.png" width="2100" /></p>
<p>Here’s a <code>ggplot2</code> version, where the colorization is extended to the lines as well as the symbols.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> specmap, <span class="fu">aes</span>(<span class="at">x=</span>Age, <span class="at">y=</span>O18, <span class="at">color=</span>Insol)) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> specmap, <span class="fu">aes</span>(<span class="at">x=</span>Age, <span class="at">y=</span>O18, <span class="at">color=</span>Insol), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>() <span class="sc">+</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_gradientn</span>(<span class="at">colours=</span><span class="fu">rev</span>(<span class="fu">brewer.pal</span>(nclr,<span class="st">&quot;PuOr&quot;</span>)))</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv3-1.png" width="2100" /></p>
<p>As we saw earlier, postive insolation anomalies are associated with trends toward lower ice volume (negative O18 values, note the y-axis labelling), and negative anomalies with increasing ice volume.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(specmap)</span></code></pre></div>
<p>Symbol color and shape can be used to encode the values of two additional variables, as demonstrated using the Summit Cr. data:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(sumcr)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(WidthWS <span class="sc">~</span> CumLen, <span class="at">pch=</span><span class="fu">as.integer</span>(Reach), <span class="at">col=</span><span class="fu">as.integer</span>(HU))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">25</span>, <span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&quot;Reach A&quot;</span>, <span class="st">&quot;Reach B&quot;</span>, <span class="st">&quot;Reach C&quot;</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">650</span>, <span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&quot;Glide&quot;</span>, <span class="st">&quot;Pool&quot;</span>, <span class="st">&quot;Riffle&quot;</span>), <span class="at">pch=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv4-1.png" width="2100" /></p>
<p>Here is the <code>ggplot2</code> version:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>CumLen, <span class="at">y=</span>WidthWS, <span class="at">shape=</span>Reach, <span class="at">color=</span>HU)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv5-1.png" width="2100" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(sumcr)</span></code></pre></div>
<p>Symbol size can be used to indicate the value of a third variable, forming a “bubble” or “balloon” plot, to indicate the value of station elevation on a simple longitude by latitude plot of the Oregon climate-station data:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(orstationc<span class="sc">$</span>lon, orstationc<span class="sc">$</span>lat, <span class="at">type=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">symbols</span>(orstationc<span class="sc">$</span>lon, orstationc<span class="sc">$</span>lat, <span class="at">circles=</span>orstationc<span class="sc">$</span>elev, <span class="at">inches=</span><span class="fl">0.1</span>, <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv6-1.png" width="2100" /></p>
<p>Here’s the equivalent plot using <code>ggplot2</code></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(orstationc, <span class="fu">aes</span>(<span class="at">x=</span>lon, <span class="at">y=</span>lat, <span class="at">size=</span>elev)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">21</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv7-1.png" width="2100" /></p>
</div>
<div id="trellislattice-like-plots" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Trellis/Lattice-like plots</h2>
<p>Multipanel Trellis or Lattice plots can be constucted, using the “faceting” approach in<code>ggplot2</code>. Here’s an example of a coplot:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(sumcr)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coplot</span>(WidthWS <span class="sc">~</span> DepthWS <span class="sc">|</span> Reach, <span class="at">pch=</span><span class="dv">14</span><span class="sc">+</span><span class="fu">as.integer</span>(Reach), <span class="at">cex=</span><span class="fl">1.5</span>, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">number=</span><span class="dv">3</span>, <span class="at">columns=</span><span class="dv">3</span>, <span class="at">overlap=</span><span class="dv">0</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel=</span><span class="cf">function</span>(x,y,...) {</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">panel.smooth</span>(x,y,<span class="at">span=</span>.<span class="dv">8</span>,<span class="at">iter=</span><span class="dv">5</span>,...)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>         <span class="fu">abline</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>       } )</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv8-1.png" width="2100" /></p>
<p>Below is a <code>ggplot2</code> version.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sumcr, <span class="fu">aes</span>(<span class="at">x=</span>DepthWS, <span class="at">y=</span>WidthWS)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Reach) </span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="ggplot2_files/figure-html/mv9-1.png" width="2100" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(sumcr)</span></code></pre></div>
<p>Multiple-variable conditioning plots can also be created. Here are styles of plot using the Yellowsone N.P. precipitation-ratio data. The first plot examines the July vs January precipitation ratios, conditioned by elevation, and the second conditioned by latitude and longitude.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create some conditioning variables</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(yellpratio)</span></code></pre></div>
<pre><code>## The following object is masked _by_ .GlobalEnv:
## 
##     Lon2</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>Elevation <span class="ot">&lt;-</span> <span class="fu">equal.count</span>(Elev,<span class="dv">4</span>,.<span class="dv">25</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>Latitude <span class="ot">&lt;-</span> <span class="fu">equal.count</span>(Lat,<span class="dv">2</span>,.<span class="dv">25</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>Longitude <span class="ot">&lt;-</span> <span class="fu">equal.count</span>(Lon,<span class="dv">2</span>,.<span class="dv">25</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># January vs July Precipitation Ratios by Elevation</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(APJan <span class="sc">~</span> APJul <span class="sc">|</span> Elevation,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">panel =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">panel.grid</span>(<span class="at">v=</span><span class="dv">2</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">panel.xyplot</span>(x, y)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">panel.abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">&quot;APJul&quot;</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> <span class="st">&quot;APJan&quot;</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot2)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv10-1.png" width="2100" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># January vs July Precipitation Ratios by Latitude and Longitude</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(APJan <span class="sc">~</span> APJul <span class="sc">|</span> Latitude<span class="sc">*</span>Longitude, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">panel =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">panel.grid</span>(<span class="at">v=</span><span class="dv">2</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">panel.xyplot</span>(x, y)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">panel.loess</span>(x, y, <span class="at">span =</span> .<span class="dv">8</span>, <span class="at">degree =</span> <span class="dv">1</span>, <span class="at">family=</span><span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">panel.abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                },</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">&quot;APJul&quot;</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> <span class="st">&quot;APJan&quot;</span>)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot3)</span></code></pre></div>
<p><img src="ggplot2_files/figure-html/mv11-1.png" width="2100" /></p>
<p>Here’s the <code>ggplot2</code> version of the first of the two plots above. First, create an elevation-zone factor, simply sorting the elevations into four equal-frequency classes. Then, produce the plot</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create an elevation zones factor</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>yellpratio<span class="sc">$</span>Elev_zones <span class="ot">&lt;-</span> <span class="fu">cut</span>(Elevation, <span class="dv">4</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Elev1 (lowest)&quot;</span>, <span class="st">&quot;Elev2&quot;</span>, <span class="st">&quot;Elev3&quot;</span>, <span class="st">&quot;Elev4 (highest)&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(yellpratio, <span class="fu">aes</span>(<span class="at">x=</span>APJul, <span class="at">y=</span>APJan)) <span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Elev_zones)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="ggplot2_files/figure-html/mv13-1.png" width="2100" /></p>
<p>Note that the panels are arranged in a different order. Elevation increases from lower left to upper right in the <code>lattice</code> plot, while it increases from upper left to lower right in the <code>ggplot2</code> version.</p>
<p>Here is a two-conditioning variables plot. The arrangement of the panels is a little different from that produced by the <code>lattice</code> plot, and the slices are not overlapping.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create conditioning variables</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>Loc_factor <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(yellpratio<span class="sc">$</span>Lat))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>Loc_factor[(yellpratio<span class="sc">$</span>Lat <span class="sc">&gt;=</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lat) <span class="sc">&amp;</span> yellpratio<span class="sc">$</span>Lon <span class="sc">&lt;</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lon))] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>Loc_factor[(yellpratio<span class="sc">$</span>Lat <span class="sc">&gt;=</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lat) <span class="sc">&amp;</span> yellpratio<span class="sc">$</span>Lon <span class="sc">&gt;=</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lon))] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>Loc_factor[(yellpratio<span class="sc">$</span>Lat <span class="sc">&lt;</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lat) <span class="sc">&amp;</span> yellpratio<span class="sc">$</span>Lon <span class="sc">&lt;</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lon))] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>Loc_factor[(yellpratio<span class="sc">$</span>Lat <span class="sc">&lt;</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lat) <span class="sc">&amp;</span> yellpratio<span class="sc">$</span>Lon <span class="sc">&gt;=</span> <span class="fu">median</span>(yellpratio<span class="sc">$</span>Lon))] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to factor, and add level lables</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>yellpratio<span class="sc">$</span>Loc_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Loc_factor)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(yellpratio<span class="sc">$</span>Loc_factor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Low Lon/High Lat&quot;</span>, <span class="st">&quot;High Lon/High Lat&quot;</span>, <span class="st">&quot;Low Lon/Low Lat&quot;</span>, <span class="st">&quot;High Lon/Low Lat&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(yellpratio, <span class="fu">aes</span>(<span class="at">x=</span>APJul, <span class="at">y=</span>APJan)) <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">span =</span> <span class="fl">0.9</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Loc_factor)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="ggplot2_files/figure-html/mv15-1.png" width="2100" /></p>
<p><a href="ggplot2.html">[Back to top]</a></p>
</div>
</div>
<div id="readings" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Readings</h1>
<ul>
<li>the main reference on <code>ggplot()</code> is Wickham, H., 2016, <em>Ggplot2, Elegant Graphics for Data Analysis</em>, eBook available on line at UO Library (search topics for “ggplot2”)</li>
<li>Peng (<em>EDA with R</em>): Ch. 14, 15</li>
<li>Kabakoff (<em>Data Visualization with R</em>): Ch. 3 - 6</li>
<li>Irizarry (<em>Introduction to Data Science</em>): Ch. 6 - 10</li>
</ul>
<p><a href="ggplot2.html">[Back to top]</a></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
