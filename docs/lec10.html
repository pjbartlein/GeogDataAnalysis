<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical inference</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="SI-md-08.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Geographic Data Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="overview.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lecture topics</li>
    <li>
      <a href="lec01.html">Introduction to the course</a>
    </li>
    <li>
      <a href="lec02.html">Univariate plots</a>
    </li>
    <li>
      <a href="lec03.html">Bivariate plots</a>
    </li>
    <li>
      <a href="lec04.html">Descriptive statistics</a>
    </li>
    <li>
      <a href="lec05.html">Multivariate plots</a>
    </li>
    <li>
      <a href="ggplot2.html">ggplot2 versions of basic plots</a>
    </li>
    <li>
      <a href="lec06.html">Maps in R</a>
    </li>
    <li>
      <a href="lec07.html">Geospatial analysis in R</a>
    </li>
    <li>
      <a href="lec08.html">Data wrangling and matrix algebra</a>
    </li>
    <li>
      <a href="lec09.html">Reference distributions</a>
    </li>
    <li>
      <a href="lec10.html">Statistical inference</a>
    </li>
    <li>
      <a href="lec11.html">Analysis of variance</a>
    </li>
    <li>
      <a href="lec12.html">Regression analysis</a>
    </li>
    <li>
      <a href="lec13.html">More regression analysis</a>
    </li>
    <li>
      <a href="lec14.html">Nonparametric regression</a>
    </li>
    <li>
      <a href="lec15.html">GLMs, GAMs, and CARTs</a>
    </li>
    <li>
      <a href="lec16.html">Principal components and factor analyses</a>
    </li>
    <li>
      <a href="lec17.html">MANOVA and discriminant analysis</a>
    </li>
    <li>
      <a href="lec18.html">Multivariate distances and cluster analysis</a>
    </li>
    <li>
      <a href="lec19.html">High-resolution and high-dimension data</a>
    </li>
    <li>
      <a href="lec20.html">Analysis and visualization of large raster data sets</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Exercises</li>
    <li>
      <a href="ex01.html">Exercise 01 -- Getting R and RStudio</a>
    </li>
    <li>
      <a href="ex02.html">Exercise 02 -- Univariate plots</a>
    </li>
    <li>
      <a href="ex03.html">Exercise 03 -- Bivariate plots and descriptive statistics</a>
    </li>
    <li>
      <a href="ex04.html">Exercise 04 -- Multivariate plots</a>
    </li>
    <li>
      <a href="ex05.html">Exercise 05 -- Data wrangling and matrix algebra</a>
    </li>
    <li>
      <a href="ex06.html">Exercise 06 -- CI's, t-tests, ANOVA</a>
    </li>
    <li>
      <a href="ex07.html">Exercise 07 -- Regression analysis</a>
    </li>
    <li>
      <a href="ex08.html">Exercise 08 -- Multivariate analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="packages-and-data.html">Packages and data</a>
    </li>
    <li>
      <a href="vm_inst.html">Virtual machine instructions</a>
    </li>
    <li>
      <a href="readings.html">Readings</a>
    </li>
    <li>
      <a href="datasets.html">Datasets</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Statistical inference</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#characterization-of-samples"><span class="toc-section-number">2</span> Characterization of samples</a>
<ul>
<li><a href="#standard-error-of-the-mean-and-confidence-interval-for-the-mean"><span class="toc-section-number">2.1</span> Standard error of the mean and confidence interval for the mean</a></li>
<li><a href="#confidence-intervals"><span class="toc-section-number">2.2</span> Confidence intervals</a></li>
</ul></li>
<li><a href="#simple-inferences-based-on-the-standard-error-of-the-mean"><span class="toc-section-number">3</span> Simple inferences based on the standard error of the mean</a>
<ul>
<li><a href="#hypothesis-tests"><span class="toc-section-number">3.1</span> Hypothesis tests</a></li>
</ul></li>
<li><a href="#the-t-test"><span class="toc-section-number">4</span> The t-test</a>
<ul>
<li><a href="#the-t-test-for-assessing-differences-in-group-means"><span class="toc-section-number">4.1</span> The <em>t</em>-test for assessing differences in group means</a></li>
<li><a href="#differences-in-group-variances"><span class="toc-section-number">4.2</span> Differences in group variances</a></li>
</ul></li>
<li><a href="#readings"><span class="toc-section-number">5</span> Readings</a></li>
</ul>
</div>

<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p>
<span style="color: #00cc00;">NOTE: This page has been revised for Winter 2021, but may undergo further edits.</span>
</p>
<div id="introduction" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>The general idea that underlies statistical inference is the comparison of particular statistics from on observational data set (i.e. the mean, the standard deviation, the differences among the means of subsets of the data), with an appropriate reference distribution in order to judge the significance of those statistics. When various assumptions are met, and specific hypotheses about the values of those statistics that should arise in practice have been specified, then statistical inference can be a powerful approach for drawing scientific conclusions that efficiently uses existing data or those collected for the specific purpose of testing those hypotheses. Even in a context when a formal experimental design is not possible, or when the objective is to explore the data, significance evaluation can be useful.</p>
<p>As a consequence of the central limit theorem, we know that the mean is normally distributed, and so we can use the normal distribution to describe the uncertainty of a sample mean.</p>
</div>
<div id="characterization-of-samples" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Characterization of samples</h1>
<p>Once a sample has been obtained, and descriptive statistics calculated, attention may then turn to the significance (representativeness as opposed to unusualness) of the sample or of the statistics. This information may be gained by comparing the specific value of a statistic with an appropriate reference distribution, and by the calculation of additional statistics that describe the level of uncertainty a particular statistic may have.</p>
<p>In the case of the sample mean, the appropriate reference distribution is the normal distribution, which is implied by the Central Limit Theorem.</p>
<div id="standard-error-of-the-mean-and-confidence-interval-for-the-mean" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Standard error of the mean and confidence interval for the mean</h2>
<p>Uncertainty in the mean can be described by the standard error of the mean or by the confidence interval for the mean. The standard error of the mean can be thought of as the standard deviation of a set mean values from repeated samples.</p>
<p>Definition of the <a href="https://pjbartlein.github.io/GeogDataAnalysis/topics/semean.pdf">standard error of the mean</a></p>
<p>Here is a demonstration using simulated data and repeated samples of different sizes</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 1000 random numbers from the normal distribution</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>npts <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>demo_mean <span class="ot">&lt;-</span> <span class="dv">5</span>; demo_sd <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data_values <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(npts, demo_mean, demo_sd)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_values); <span class="fu">mean</span>(data_values); <span class="fu">sd</span>(data_values)</span></code></pre></div>
<p><img src="lec10_files/figure-html/semean01-1.png" width="2100" /></p>
<pre><code>## [1] 5.034757</code></pre>
<pre><code>## [1] 1.966487</code></pre>
<p>Set the number of replications <code>nreps</code> and the (maximum) sample size</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># number of replications (samples) for each sample size</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>max_sample_size <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of example sample sizes</span></span></code></pre></div>
<p>Create several matrices to hold the individual replication results.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix to hold means of each of the nreps samples</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mean_samp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span>nreps)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># matrices to hold means, sd’s and sample sizes for for each n</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>average_means <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span>(max_sample_size<span class="dv">-1</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>sd_means <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span>(max_sample_size<span class="dv">-1</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span>(max_sample_size<span class="dv">-1</span>))</span></code></pre></div>
<p>Generate means for a range of sample sizes (1:max_sample_size)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,max_sample_size<span class="dv">-1</span>)) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># for each sample size generate nreps samples and get their mean</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,nreps)) {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(data_values, n<span class="sc">+</span><span class="dv">1</span>, <span class="at">replace=</span>T)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         mean_samp[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(samp)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># get the average and standard deviation of the nreps means</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>   average_means[n] <span class="ot">&lt;-</span> <span class="fu">apply</span>(mean_samp,<span class="dv">2</span>,mean)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>   sd_means[n] <span class="ot">&lt;-</span> <span class="fu">apply</span>(mean_samp,<span class="dv">2</span>,sd)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>   sample_size[n] <span class="ot">&lt;-</span> n<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Take a look at the means and the standard errors. Note that means remain essentially constant across the range of sample sizes, while the standard errors decrease rapidly (at first) with increasing sample size.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample_size, average_means, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">5.5</span>), <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="lec10_files/figure-html/semean05-1.png" width="2100" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample_size, sd_means, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="lec10_files/figure-html/semean05-2.png" width="2100" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(average_means,sd_means,sample_size))</span></code></pre></div>
<pre><code>##          [,1]      [,2] [,3]
## [1,] 5.002194 1.3991343    2
## [2,] 4.992911 1.1747384    3
## [3,] 5.059321 0.9902242    4
## [4,] 5.031235 0.8585874    5
## [5,] 5.031041 0.8160077    6
## [6,] 5.015314 0.7535537    7</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">cbind</span>(average_means,sd_means,sample_size))</span></code></pre></div>
<pre><code>##           [,1]      [,2] [,3]
## [94,] 5.036694 0.1899069   95
## [95,] 5.041825 0.1985795   96
## [96,] 5.044742 0.2041062   97
## [97,] 5.036726 0.2012360   98
## [98,] 5.040909 0.2003633   99
## [99,] 5.038318 0.2000125  100</code></pre>
<p>Verify that the standard error of the mean is sigma/sqrt(n)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(demo_sd<span class="sc">/</span><span class="fu">sqrt</span>((<span class="dv">2</span><span class="sc">:</span>max_sample_size)), sd_means, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="lec10_files/figure-html/semean06-1.png" width="2100" /></p>
<p>Generate some data values, this time from a uniform distribution</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data_values from a uniform distribution</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>data_values <span class="ot">&lt;-</span> <span class="fu">runif</span>(npts, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_values); <span class="fu">mean</span>(data_values); <span class="fu">sd</span>(data_values)</span></code></pre></div>
<p><img src="lec10_files/figure-html/semean07-1.png" width="2100" /></p>
<pre><code>## [1] 0.5087177</code></pre>
<pre><code>## [1] 0.2835326</code></pre>
<p>Rescale these values so that they have the same mean (<code>demo_mean</code>) and standard deviation (<code>demo_sd</code>) as in the previous example,</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rescale the data_values so they have a mean of demo_mean</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and a standard deviation of demo_sd (standardize, then rescale)</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>data_values <span class="ot">&lt;-</span> (data_values<span class="sc">-</span><span class="fu">mean</span>(data_values))<span class="sc">/</span><span class="fu">sd</span>(data_values)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data_values); <span class="fu">sd</span>(data_values)</span></code></pre></div>
<pre><code>## [1] 4.369281e-18</code></pre>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data_values <span class="ot">&lt;-</span> (data_values<span class="sc">*</span>demo_sd)<span class="sc">+</span>demo_mean</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_values); <span class="fu">mean</span>(data_values); <span class="fu">sd</span>(data_values)</span></code></pre></div>
<p><img src="lec10_files/figure-html/semean08-1.png" width="2100" /></p>
<pre><code>## [1] 5</code></pre>
<pre><code>## [1] 2</code></pre>
<p>Repeat the demonstration</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,max_sample_size<span class="dv">-1</span>)) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># for each sample size generate nreps samples and get their mean</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,nreps)) {</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>         samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(data_values, n<span class="sc">+</span><span class="dv">1</span>, <span class="at">replace=</span>T)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>         mean_samp[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(samp)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>   <span class="co"># get the average and standard deviation of the nreps means</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>   average_means[n] <span class="ot">&lt;-</span> <span class="fu">apply</span>(mean_samp,<span class="dv">2</span>,mean)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>   sd_means[n] <span class="ot">&lt;-</span> <span class="fu">apply</span>(mean_samp,<span class="dv">2</span>,sd)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>   sample_size[n] <span class="ot">&lt;-</span> n<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample_size, sd_means, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="lec10_files/figure-html/semean09-1.png" width="2100" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(average_means,sd_means,sample_size))</span></code></pre></div>
<pre><code>##          [,1]      [,2] [,3]
## [1,] 5.009442 1.4284970    2
## [2,] 5.012839 1.1621002    3
## [3,] 4.918761 0.9917057    4
## [4,] 5.004906 0.9018073    5
## [5,] 4.975955 0.8187180    6
## [6,] 5.022585 0.7554809    7</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">cbind</span>(average_means,sd_means,sample_size))</span></code></pre></div>
<pre><code>##           [,1]      [,2] [,3]
## [94,] 5.004614 0.2007629   95
## [95,] 5.015275 0.2047870   96
## [96,] 4.999232 0.2094253   97
## [97,] 4.996611 0.2028047   98
## [98,] 5.003051 0.1943208   99
## [99,] 5.003415 0.2052365  100</code></pre>
<p>This demonstrates that the standard error of the mean is insensitive to the underlying distribution of the data_</p>
</div>
<div id="confidence-intervals" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Confidence intervals</h2>
<p>The confidence interval provides a verbal or graphical characterization, based on the information in a sample, of the likely range of values within which the “true” or population mean lies. This example uses an artificial data set <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/csv/cidat.csv">[cidat.csv]</a></p>
<p><code>cidat</code> is a data frame that can be generated as follows</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 4000 random values from the Normal Distribution with mean=10, and standard deviation=1</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>NormDat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">mean=</span><span class="dv">10</span>, <span class="at">sd=</span><span class="dv">1</span>, <span class="at">n=</span><span class="dv">4000</span>) </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a &quot;grouping variable&quot; that defines 40 groups, each with 100 observations</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>Group <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>,<span class="dv">100</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>cidat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(NormDat, Group)) <span class="co"># make a data frame</span></span></code></pre></div>
<p>Attach and summarize the data set.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(cidat)</span></code></pre></div>
<pre><code>## The following objects are masked _by_ .GlobalEnv:
## 
##     Group, NormDat</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cidat)</span></code></pre></div>
<pre><code>##     NormDat           Group      
##  Min.   : 6.322   Min.   : 1.00  
##  1st Qu.: 9.357   1st Qu.:10.75  
##  Median :10.030   Median :20.50  
##  Mean   :10.030   Mean   :20.50  
##  3rd Qu.:10.703   3rd Qu.:30.25  
##  Max.   :13.627   Max.   :40.00</code></pre>
<p>The idea here is to imagine that each group of 100 observations represents one possible sample of some underlying process or information set, that might occur in practice. These hypothetical samples (which are each equally likely) provide a mechanism for illustrating the range of values of the mean that could occur simply due to natural variability of the data, and the “confidence interal” is that range of values of the mean that enclose 90% of the possible mean values.</p>
<p>Get the means and standard errors of each group_</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>group_means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(NormDat, Group, mean)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>group_sd <span class="ot">&lt;-</span> <span class="fu">tapply</span>(NormDat, Group, sd)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>group_npts <span class="ot">&lt;-</span> <span class="fu">tapply</span>(NormDat, Group, length)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>group_semean <span class="ot">&lt;-</span> (group_sd<span class="sc">/</span>(<span class="fu">sqrt</span>(group_npts)))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(group_means)</span></code></pre></div>
<pre><code>## [1] 10.02969</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(group_means)</span></code></pre></div>
<pre><code>## [1] 0.09699701</code></pre>
<p>Plot the individual samples (top plot) and then the means, and their standard errors (bottom plot). Note the different scales on the plots.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot means and data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Group, NormDat)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(group_means, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot means and standard errors of means</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(group_means, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">11</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">xlab=</span><span class="st">&quot;Group&quot;</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(group_means <span class="sc">+</span> <span class="fl">2.0</span><span class="sc">*</span>group_semean , <span class="at">pch=</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(group_means <span class="sc">-</span> <span class="fl">2.0</span><span class="sc">*</span>group_semean , <span class="at">pch=</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">10</span>,<span class="dv">0</span>)</span></code></pre></div>
<p><img src="lec10_files/figure-html/semean13-1.png" width="2100" /></p>
<p>The bottom plot shows that out the 40 mean values (red dots), 2 (0.05 or 5 percent) have intervals (defined to be twice the standard error either side of the mean, black tick marks) that do not enclose the “true” value of the mean (10.0).</p>
<p>Set the graphics window back to normal and detach <code>cidat</code>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(cidat)</span></code></pre></div>
<p><a href="lec10.html">[Back to top]</a></p>
</div>
</div>
<div id="simple-inferences-based-on-the-standard-error-of-the-mean" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Simple inferences based on the standard error of the mean</h1>
<p>The standard error of the mean, along with the knowledge that the sample mean is normally distributed allows inferences about the mean to made For example, questions of the following kind can be answered:</p>
<ul>
<li>What is the probability of occurrence of an observation with a particular value?</li>
<li>What is the probability of occurrence of a sample mean with a particular value?</li>
<li>What is the “confidence interval” for a sample mean with a particular value?</li>
</ul>
<p>Here’s a short discussion of simple inferential statistics:</p>
<ul>
<li><a href="https://pjbartlein.github.io/GeogDataAnalysis/topics/simpleinf.pdf">[simple inferential statistics]</a></li>
</ul>
<p><a href="lec10.html">[Back to top]</a></p>
<div id="hypothesis-tests" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Hypothesis tests</h2>
<p>The next step toward statistical inference is the more formal development and testing of specific hypotheses (as opposed to the rather informal inspection of descriptive plots, confidence intervals, etc.)</p>
<p>“Hypothesis” is a word used in several contexts in data analysis or statistics:</p>
<ul>
<li>the <em>research hypothesis</em> is the general scientific issue that is being explored by a data analysis. It may take the form of quite specific statements, or just general speculations.</li>
<li>the <em>null hypothesis</em> (H<sub>o</sub>) is a specific statement whose truthfulness can be evaluated by a particular statistical test. An example of a null hypothesis is that the means of two groups of observations are identical.</li>
<li>the <em>alternative hypothesis</em> (H<sub>a</sub>) is, as its name suggests an alternative statement of what situation is true, in the event that the null hypothesis is rejected. An example of an alternative hypothesis to a null hypothesis that the means of two groups of observations are identical is that the means are not identical.</li>
</ul>
<p>A null hypothesis is <em>never</em> “proven” by a statistical test. Tests may only reject, or fail to reject, a null hypothesis.</p>
<p>There are two general approaches toward setting up and testing specific hypotheses: the “classical approach” and the “p-value” approach.</p>
<p>The steps in the classical approach:</p>
<ol style="list-style-type: decimal">
<li>define or state the null and alternative hypotheses.</li>
<li>select a test statistic.</li>
<li>select a significance level, or a specific probability level, which if exceeded, signals that the test statistic is large enough to consider significant.</li>
<li>delineate the “rejection region” under the pdf of the appropriate distribution for the test statistic, (i.e. determine the specific value of the test statistic that if exceeded would be grounds to consider it significant.</li>
<li>compute the test statistic.</li>
<li>depending on the particular value of the test statistics either a) reject the null hypothesis (H<sub>o</sub>) and accept the alternative hypothesis (H<sub>a</sub>), or b) fail to reject the null hypothesis.</li>
</ol>
<p>The steps in the “p-value” approach are:</p>
<ol style="list-style-type: decimal">
<li>define or state the null and alternative hypotheses.</li>
<li>select and compute the test statistic.</li>
<li>refer the test statistic to its appropriate reference distribution.</li>
<li>calculate the probability that a value of the test statistic as large as that observed would occur by chance if the null hypothesis were true (this probability, or <em>p-value</em>, is called the significance level).</li>
<li>if the significance level is small, the tested hypothesis (H<sub>o</sub>) is discredited, and we assert that a “significant result” or “significant difference” has been observed.</li>
</ol>
<ul>
<li><a href="https://pjbartlein.github.io/GeogDataAnalysis/topics/interpstats.pdf">[short guide to interpreting test statistics, <em>p</em>-values, and significance]</a></li>
</ul>
<p><a href="lec10.html">[Back to top]</a></p>
</div>
</div>
<div id="the-t-test" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> The t-test</h1>
<p>An illustration of an hypothesis test that is frequently used in practice is provided by the <em>t</em>-test, one of several “difference-of-means” tests. The t-test (or more particularly <em>Student’s t-test</em> (after the pseudonym of its author, W.S. Gosset) provides a mechanism for the simple task of testing whether there is a significant difference between two groups of observations, as reflected by differences in the means of the two groups. In the <em>t</em>-test, two sample mean values, or a sample mean and a theoretical mean value, are compared as follows:</p>
<ul>
<li>the null hypthesis is that the two mean values are equal, while the</li>
<li>alternative hypothesis is that the means are not equal (or that one is greater than or less than the other)<br />
</li>
<li>the test statistic is the <em>t</em>-statistic</li>
<li>the significance level or <em>p</em>-value is determined using the* <em>t</em>-distribution</li>
</ul>
<p>The shape of the <em>t</em> distribution can be visualized as follows (for df=30):</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>, <span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>pdf_t <span class="ot">&lt;-</span> <span class="fu">dt</span>(x,<span class="dv">3</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pdf_t <span class="sc">~</span> x, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="lec10_files/figure-html/ttest01-1.png" width="2100" /></p>
<p>You can read about the origin of Gosset’s pseudonum (and his contributions to brewing) <a href="http://pubs.aeaweb.org/doi/pdfplus/10.1257/jep.22.4.199">here</a>.</p>
<div id="the-t-test-for-assessing-differences-in-group-means" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> The <em>t</em>-test for assessing differences in group means</h2>
<p><a href="https://pjbartlein.github.io/GeogDataAnalysis/topics/ttest.pdf">[Details of the t-test]</a></p>
<p>There are two ways the <em>t</em>-test is implemented in practice, depending on the nature of the question being asked and hence on the nature of the null hypotheis:</p>
<ul>
<li>one-sample <em>t</em>-test (for testing the hypothesis that a sample mean is equal to a “known” or “theoretical” value), or the<br />
</li>
<li>two-sample <em>t</em>-test (for testing the hypothesis that the means of two groups of observations are identical).</li>
</ul>
<p>Example data sets:</p>
<ul>
<li><a href="https://pjbartlein.github.io/GeogDataAnalysis/data/csv/ttestdat.csv">[ttestdat.csv]</a></li>
<li><a href="https://pjbartlein.github.io/GeogDataAnalysis/data/csv/foursamples.csv">[foursamples.csv]</a></li>
</ul>
<p>Attach the example data, and get a boxplot of the data by group:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-tests</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ttestdat)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Set1 <span class="sc">~</span> Group1)</span></code></pre></div>
<p><img src="lec10_files/figure-html/ttest02-1.png" width="2100" /></p>
<p>Two-tailed <em>t</em>-test (are the means different in a general way?)</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two-tailed tests</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Set1 <span class="sc">~</span> Group1)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Set1 by Group1
## t = -0.2071, df = 55.818, p-value = 0.8367
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.11841233  0.09622446
## sample estimates:
## mean in group 0 mean in group 1 
##        7.988305        7.999399</code></pre>
<p>The <em>t</em>-statistic is -0.2071 and the <em>p</em>-value = 0.8367, which indicates that the <em>t</em>-statistic is not significant, i.e. that there is little support for rejecting the null hypothesis that there is no difference between the mean of group 0 and the mean of group 1.</p>
<p>Two one-tailed <em>t</em>-tests (each evaluates whether the means are different in a specific way?)</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Set1 <span class="sc">~</span> Group1, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)    <span class="co"># i.e. mean of group 0 is less than the mean of group 1</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Set1 by Group1
## t = -0.2071, df = 55.818, p-value = 0.4183
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf 0.07850556
## sample estimates:
## mean in group 0 mean in group 1 
##        7.988305        7.999399</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Set1 <span class="sc">~</span> Group1, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>) <span class="co"># i.e. mean of group 0 is greater than the mean of group 1</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Set1 by Group1
## t = -0.2071, df = 55.818, p-value = 0.5817
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  -0.1006934        Inf
## sample estimates:
## mean in group 0 mean in group 1 
##        7.988305        7.999399</code></pre>
<p>Notice that for each example, the statistics (<em>t</em>-statistic, means of each group), are identical, while the <em>p</em>-values, and confidence intervals for the <em>t</em>-statistic differ). The smallest <em>p</em>-value is obtained for the test of the hypothes that the mean of group 0 is less than the mean of group 1 (which is the observed difference). <em>But</em>, that difference is not significant (the <em>p</em>-value is greater than 0.05).</p>
<p>A a second example</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Set2 <span class="sc">~</span> Group2)</span></code></pre></div>
<p><img src="lec10_files/figure-html/ttest05-1.png" width="2100" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Set2 <span class="sc">~</span> Group2)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Set2 by Group2
## t = 6.9733, df = 57.372, p-value = 3.419e-09
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.2772856 0.5006463
## sample estimates:
## mean in group 0 mean in group 1 
##        7.988305        7.599339</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ttestdat)</span></code></pre></div>
<p>Here the <em>t</em>-statistic is relatively large and the <em>p</em>-value very small, lending support for rejecting the null hypothesis of no significant difference in the means (and accepting the alternative hypothesis that the means do differ). Remember, we haven’t “proven” that they differ, we’ve only rejected the idea that they are identical.</p>
</div>
<div id="differences-in-group-variances" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Differences in group variances</h2>
<p>One assumption that underlies the <em>t</em>-test is that the variances (or dispersions) of the two samples are equal. A modification of the basic test allows cases when the variances are approximately equal to be handled, but large differences in variability between the two groups can have an impact on the interpretability of the test results:</p>
<p>Example data: <a href="https://pjbartlein.github.io/GeogDataAnalysis/data/csv/foursamples.csv">[foursamples.csv]</a></p>
<p><em>t</em>-tests among groups with different variances</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(foursamples)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nice histograms</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>cutpts <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.0</span>, <span class="fl">20.0</span>, <span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Sample1, <span class="at">breaks=</span>cutpts, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Sample2, <span class="at">breaks=</span>cutpts, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>))</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Sample3, <span class="at">breaks=</span>cutpts, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>))</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Sample4, <span class="at">breaks=</span>cutpts, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>))</span></code></pre></div>
<p><img src="lec10_files/figure-html/ttest06-1.png" width="2100" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Sample1, Sample2, Sample3, Sample4)</span></code></pre></div>
<p><img src="lec10_files/figure-html/ttest06-2.png" width="2100" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Sample1)<span class="sc">-</span><span class="fu">mean</span>(Sample2)</span></code></pre></div>
<pre><code>## [1] -0.2718703</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Sample1, Sample2)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Sample1 and Sample2
## t = -1.7294, df = 997.9, p-value = 0.08404
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.58035326  0.03661273
## sample estimates:
## mean of x mean of y 
##  10.72631  10.99818</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Sample3)<span class="sc">-</span><span class="fu">mean</span>(Sample4)</span></code></pre></div>
<pre><code>## [1] -0.2676365</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Sample3, Sample4)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Sample3 and Sample4
## t = -4.2308, df = 998, p-value = 2.543e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.3917738 -0.1434991
## sample estimates:
## mean of x mean of y 
##  10.73264  11.00027</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Sample1)<span class="sc">-</span><span class="fu">mean</span>(Sample3)</span></code></pre></div>
<pre><code>## [1] -0.006325667</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Sample1, Sample3)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Sample1 and Sample3
## t = -0.053011, df = 658.3, p-value = 0.9577
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.2406330  0.2279816
## sample estimates:
## mean of x mean of y 
##  10.72631  10.73264</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Sample2)<span class="sc">-</span><span class="fu">mean</span>(Sample4)</span></code></pre></div>
<pre><code>## [1] -0.002091883</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Sample2, Sample4)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Sample2 and Sample4
## t = -0.017387, df = 654.69, p-value = 0.9861
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.2383369  0.2341532
## sample estimates:
## mean of x mean of y 
##  10.99818  11.00027</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(foursamples)</span></code></pre></div>
<p>There is a formal test for equality of group variances that will be described with analysis of variance.</p>
<p><a href="lec10.html">[Back to top]</a></p>
</div>
</div>
<div id="readings" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Readings</h1>
<ul>
<li>Owen (The R Guide): Ch. 7.1</li>
<li>Irizarry (<em>Intro to Data Science</em>): Ch. 12 - 15</li>
</ul>
<p><a href="lec09.html">[Back to top]</a></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
